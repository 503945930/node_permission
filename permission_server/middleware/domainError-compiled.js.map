{"version":3,"sources":["domainError.js"],"names":[],"mappings":";;;;;AAGA,IAAI,MAAM,CAAC;;AAEX,MAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;;AAE3B,MAAM,CAAC,OAAO,GAAG,YAAW;AACxB,WAAO,UAAS,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE;AAC5B,YAAI,CAAC,CAAC;AACN,SAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC;AACpB,SAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AACX,SAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AACX,SAAC,CAAC,gBAAgB,GAAG,CAAC,CAAC;AACvB,SAAC,CAAC,EAAE,CAAC,OAAO,EAAE,UAAS,GAAG,EAAE;AACxB,aAAC,CAAC,gBAAgB,EAAE,CAAC;AACrB,gBAAI,CAAC,CAAC,gBAAgB,GAAG,CAAC,EAAE;AACxB,uBAAO;aACV;AACD,eAAG,CAAC,SAAS,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;AACrC,mBAAO,IAAI,CAAC,GAAG,CAAC,CAAC;SACpB,CAAC,CAAC;AACH,eAAO,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;KACtB,CAAC;CACL,CAAC","file":"domainError-compiled.js","sourcesContent":["/**\r\n * Created by Administrator on 2015/9/9 0009.\r\n */\r\nvar domain;\r\n\r\ndomain = require(\"domain\");\r\n\r\nmodule.exports = function() {\r\n    return function(req, res, next) {\r\n        var d;\r\n        d = domain.create();\r\n        d.add(req);\r\n        d.add(res);\r\n        d._throwErrorCount = 0;\r\n        d.on(\"error\", function(err) {\r\n            d._throwErrorCount++;\r\n            if (d._throwErrorCount > 1) {\r\n                return;\r\n            }\r\n            res.setHeader(\"Connection\", \"close\");\r\n            return next(err);\r\n        });\r\n        return d.run(next);\r\n    };\r\n};"]}