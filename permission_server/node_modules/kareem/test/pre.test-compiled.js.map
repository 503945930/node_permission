{"version":3,"sources":["pre.test.js"],"names":[],"mappings":"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","file":"pre.test-compiled.js","sourcesContent":["var assert = require('assert');\nvar Kareem = require('../');\n\ndescribe('execPre', function() {\n  var hooks;\n\n  beforeEach(function() {\n    hooks = new Kareem();\n  });\n\n  it('handles errors with multiple pres', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', function(done) {\n      execed.first = true;\n      done();\n    });\n\n    hooks.pre('cook', function(done) {\n      execed.second = true;\n      done('error!');\n    });\n\n    hooks.pre('cook', function(done) {\n      execed.third = true;\n      done();\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.equal('error!', err);\n      assert.equal(2, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      done();\n    });\n  });\n\n  it('handles async errors', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.first = true;\n      setTimeout(\n        function() {\n          done('error!');\n        },\n        5);\n\n      next();\n    });\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.second = true;\n      setTimeout(\n        function() {\n          done('other error!');\n        },\n        10);\n\n      next();\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.equal('error!', err);\n      assert.equal(2, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      done();\n    });\n  });\n\n  it('handles async errors in next()', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.first = true;\n      setTimeout(\n        function() {\n          done('other error!');\n        },\n        15);\n\n      next();\n    });\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.second = true;\n      setTimeout(\n        function() {\n          next('error!');\n          done('another error!');\n        },\n        5);\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.equal('error!', err);\n      assert.equal(2, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      done();\n    });\n  });\n\n  it('handles async errors in next() when already done', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.first = true;\n      setTimeout(\n        function() {\n          done('other error!');\n        },\n        5);\n\n      next();\n    });\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.second = true;\n      setTimeout(\n        function() {\n          next('error!');\n          done('another error!');\n        },\n        25);\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.equal('other error!', err);\n      assert.equal(2, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      done();\n    });\n  });\n\n  it('returns correct error when async pre errors', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.first = true;\n      setTimeout(\n        function() {\n          done('other error!');\n        },\n        5);\n\n      next();\n    });\n\n    hooks.pre('cook', function(next) {\n      execed.second = true;\n      setTimeout(\n        function() {\n          next('error!');\n        },\n        15);\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.equal('other error!', err);\n      assert.equal(2, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      done();\n    });\n  });\n\n  it('lets async pres run when fully sync pres are done', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.first = true;\n      setTimeout(\n        function() {\n          done();\n        },\n        5);\n\n      next();\n    });\n\n    hooks.pre('cook', function() {\n      execed.second = true;\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.ifError(err);\n      assert.equal(2, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      done();\n    });\n  });\n\n  it('allows passing arguments to the next pre', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', function(next) {\n      execed.first = true;\n      next(null, 'test');\n    });\n\n    hooks.pre('cook', function(next, p) {\n      execed.second = true;\n      assert.equal(p, 'test');\n      next();\n    });\n\n    hooks.pre('cook', function(next, p) {\n      execed.third = true;\n      assert.ok(!p);\n      next();\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.ifError(err);\n      assert.equal(3, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      assert.ok(execed.third);\n      done();\n    });\n  });\n});\n"]}