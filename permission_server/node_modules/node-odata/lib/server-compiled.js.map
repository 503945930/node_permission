{"version":3,"sources":["server.js"],"names":[],"mappings":"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","file":"server-compiled.js","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _express = require('express');\n\nvar _express2 = _interopRequireDefault(_express);\n\nvar _bodyParser = require('body-parser');\n\nvar _bodyParser2 = _interopRequireDefault(_bodyParser);\n\nvar _methodOverride = require('method-override');\n\nvar _methodOverride2 = _interopRequireDefault(_methodOverride);\n\nvar _mongoose = require('mongoose');\n\nvar _mongoose2 = _interopRequireDefault(_mongoose);\n\nvar _cors = require('cors');\n\nvar _cors2 = _interopRequireDefault(_cors);\n\nvar _lodash = require('lodash');\n\nvar _metadataParser = require('./metadata/parser');\n\nvar _metadataParser2 = _interopRequireDefault(_metadataParser);\n\nvar _model = require('./model');\n\nvar _model2 = _interopRequireDefault(_model);\n\nvar _rest = require('./rest');\n\nvar _rest2 = _interopRequireDefault(_rest);\n\nvar _resource = require('./resource');\n\nvar _resource2 = _interopRequireDefault(_resource);\n\nvar Server = (function () {\n  function Server(db, prefix) {\n    _classCallCheck(this, Server);\n\n    this._app = (0, _express2['default'])();\n    this._app.use(_bodyParser2['default'].urlencoded({ extended: true }));\n    this._app.use(_bodyParser2['default'].json());\n    this._app.use((0, _methodOverride2['default'])());\n    this._app.use(_express2['default'].query());\n    this._app.use((0, _cors2['default'])());\n    this._app.disable('x-powered-by');\n    this._mongoose = _mongoose2['default'];\n    this._settings = {\n      maxTop: 10000,\n      maxSkip: 10000,\n      orderby: undefined };\n    this.defaultConfiguration(db, prefix);\n\n    // TODO: Infact, resources is a mongooseModel instance, origin name is repositories.\n    // Should mix _resources object and resources object: _resources + resource = resources.\n    // Encapsulation to a object, separate mognoose, try to use *repository pattern*.\n    this._resources = [];\n    this.resources = {};\n\n    // metadata\n    // this._app.get(this.settings.prefix || '/', (req, res, next) => {\n    //   const resources = {};\n    //   this.resources.map(function(item){\n    //     resources[item.url] = parser.toMetadata(item.model);\n    //   });\n    //   res.json({ resources });\n    // });\n  }\n\n  _createClass(Server, [{\n    key: 'defaultConfiguration',\n    value: function defaultConfiguration(db) {\n      var prefix = arguments[1] === undefined ? '' : arguments[1];\n\n      this.set('app', this._app);\n      this.set('db', db);\n      this.set('prefix', prefix);\n    }\n  }, {\n    key: 'resource',\n    value: function resource(name, model) {\n      if (model === undefined) {\n        return this._resources.name;\n      }\n      var resource = new _resource2['default'](name, model);\n      this._resources.push(resource);\n      return resource;\n    }\n  }, {\n    key: 'post',\n\n    // expose functions method\n    value: function post(url, callback, auth) {\n      var app = this.get('app');\n      var prefix = this.get('prefix');\n      app.post('' + prefix + '' + url, function (req, res, next) {\n        if (checkAuth(auth, req)) {\n          callback(req, res, next);\n        } else {\n          res.status(401).end();\n        }\n      });\n    }\n  }, {\n    key: 'put',\n    value: function put(url, callback, auth) {\n      var app = this.get('app');\n      var prefix = this.get('prefix');\n      app.put('' + prefix + '' + url, function (req, res, next) {\n        if (checkAuth(auth, req)) {\n          callback(req, res, next);\n        } else {\n          res.status(401).end();\n        }\n      });\n    }\n  }, {\n    key: 'delete',\n    value: function _delete(url, callback, auth) {\n      var app = this.get('app');\n      var prefix = this.get('prefix');\n      app['delete']('' + prefix + '' + url, function (req, res, next) {\n        if (checkAuth(auth, req)) {\n          callback(req, res, next);\n        } else {\n          res.status(401).end();\n        }\n      });\n    }\n  }, {\n    key: 'listen',\n    value: function listen() {\n      var _this = this;\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      this._resources.map(function (resource) {\n        var router = resource._router(_this._db, _this._settings);\n        _this._app.use(_this.get('prefix'), router);\n        _this.resources[resource._name] = _this._db.model(resource._name);\n      });\n      return this._app.listen.apply(this._app, args);\n    }\n  }, {\n    key: 'use',\n    value: function use() {\n      for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      if (args.length === 1 && args[0] instanceof _resource2['default']) {\n        this._resources.push(args[0]);\n        return;\n      }\n      this._app.use.apply(this._app, args);\n    }\n  }, {\n    key: 'get',\n    value: function get(key, callback, auth) {\n      if (callback === undefined) {\n        return this._settings[key];\n      }\n      // TODO: Need to refactor, same as L70-L80\n      var app = this.get('app');\n      var prefix = this.get('prefix');\n      app.get('' + prefix + '' + key, function (req, res, next) {\n        if (checkAuth(auth, req)) {\n          callback(req, res, next);\n        } else {\n          res.status(401).end();\n        }\n      });\n    }\n  }, {\n    key: 'set',\n    value: function set(key, val) {\n      switch (key) {\n        case 'db':\n          this._db = _mongoose2['default'].createConnection(val);\n          break;\n        case 'prefix':\n          if (val === '/') {\n            val = '';\n          }\n          if (val.length > 0 && val[0] !== '/') {\n            val = '/' + val;\n          }\n          break;\n      }\n      this._settings[key] = val;\n      return this;\n    }\n  }]);\n\n  return Server;\n})();\n\nfunction checkAuth(auth, req) {\n  if (!auth) {\n    return true;\n  }\n  return auth(req);\n}\n\n// expose privite object for special situation.\nexports['default'] = Server;\nmodule.exports = exports['default'];"]}