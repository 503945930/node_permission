{"version":3,"sources":["idPlugin.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;AAEb,MAAM,CAAC,cAAc,CAAC,OAAO,EAAE,YAAY,EAAE;AAC3C,OAAK,EAAE,IAAI;CACZ,CAAC,CAAC;;AAEH,SAAS,sBAAsB,CAAC,GAAG,EAAE;AAAE,SAAO,GAAG,IAAI,GAAG,CAAC,UAAU,GAAG,GAAG,GAAG,EAAE,SAAS,EAAE,GAAG,EAAE,CAAC;CAAE;;AAEjG,IAAI,SAAS,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC;;AAErC,IAAI,UAAU,GAAG,sBAAsB,CAAC,SAAS,CAAC,CAAC;;AAEnD,OAAO,CAAC,SAAS,CAAC,GAAG,UAAU,MAAM,EAAE,OAAO,EAAE;;;AAG9C,MAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,EAAE;AACrB,UAAM,CAAC,GAAG,CAAC;AACT,SAAG,EAAE;AACH,YAAI,EAAE,MAAM;AACZ,cAAM,EAAE,IAAI,EAAE;KACjB,CAAC,CAAC;GACJ;;;AAGD,MAAI,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE,EAAE;AACpB,UAAM,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,YAAY;AACnC,aAAO,IAAI,CAAC,GAAG,CAAC;KACjB,CAAC,CAAC;AACH,UAAM,CAAC,GAAG,CAAC,UAAU,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC;AAC3C,UAAM,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC;GAC1C;;;AAGD,MAAI,CAAC,MAAM,CAAC,OAAO,CAAC,QAAQ,EAAE;AAC5B,UAAM,CAAC,OAAO,CAAC,QAAQ,GAAG,EAAE,CAAC;GAC9B;AACD,MAAI,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,EAAE;AAC1B,UAAM,CAAC,OAAO,CAAC,MAAM,GAAG,EAAE,CAAC;GAC5B;AACD,MAAI,MAAM,GAAG,SAAS,MAAM,CAAC,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE;AAC9C,WAAO,GAAG,CAAC,GAAG,CAAC;AACf,QAAI,CAAC,GAAG,CAAC,EAAE,EAAE;AACX,aAAO,GAAG,CAAC,EAAE,CAAC;KACf;AACD,WAAO,GAAG,CAAC;GACZ,CAAC;AACF,QAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,SAAS,GAAG,MAAM,CAAC;AAC3C,QAAM,CAAC,OAAO,CAAC,MAAM,CAAC,SAAS,GAAG,MAAM,CAAC;;;AAGzC,QAAM,CAAC,GAAG,CAAC,MAAM,EAAE,UAAU,IAAI,EAAE;AACjC,QAAI,IAAI,CAAC,KAAK,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;AAC3B,UAAI,CAAC,GAAG,GAAG,UAAU,CAAC,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC;KACvC;AACD,WAAO,IAAI,EAAE,CAAC;GACf,CAAC,CAAC;CACJ,CAAC;;AAEF,MAAM,CAAC,OAAO,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC","file":"idPlugin-compiled.js","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _nodeUuid = require('node-uuid');\n\nvar _nodeUuid2 = _interopRequireDefault(_nodeUuid);\n\nexports['default'] = function (schema, options) {\n\n  // add _id to schema.\n  if (!schema.paths._id) {\n    schema.add({\n      _id: {\n        type: String,\n        unique: true }\n    });\n  }\n\n  // display value of _id when request id.\n  if (!schema.paths.id) {\n    schema.virtual('id').get(function () {\n      return this._id;\n    });\n    schema.set('toObject', { virtuals: true });\n    schema.set('toJSON', { virtuals: true });\n  }\n\n  // reomove _id when serialization.\n  if (!schema.options.toObject) {\n    schema.options.toObject = {};\n  }\n  if (!schema.options.toJSON) {\n    schema.options.toJSON = {};\n  }\n  var remove = function remove(doc, ret, options) {\n    delete ret._id;\n    if (!ret.id) {\n      delete ret.id;\n    }\n    return ret;\n  };\n  schema.options.toObject.transform = remove;\n  schema.options.toJSON.transform = remove;\n\n  // genarate _id.\n  schema.pre('save', function (next) {\n    if (this.isNew && !this._id) {\n      this._id = _nodeUuid2['default'].v4();\n    }\n    return next();\n  });\n};\n\nmodule.exports = exports['default'];"]}