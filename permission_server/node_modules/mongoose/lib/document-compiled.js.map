{"version":3,"sources":["document.js"],"names":[],"mappings":"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","file":"document-compiled.js","sourcesContent":["/*!\n * Module dependencies.\n */\n\nvar EventEmitter = require('events').EventEmitter\n  , setMaxListeners = EventEmitter.prototype.setMaxListeners\n  , MongooseError = require('./error')\n  , MixedSchema = require('./schema/mixed')\n  , Schema = require('./schema')\n  , ObjectId = require('./types/objectid')\n  , ValidatorError = require('./schematype').ValidatorError\n  , utils = require('./utils')\n  , clone = utils.clone\n  , isMongooseObject = utils.isMongooseObject\n  , inspect = require('util').inspect\n  , ValidationError = MongooseError.ValidationError\n  , InternalCache = require('./internal')\n  , deepEqual = utils.deepEqual\n  , hooks = require('hooks-fixed')\n  , Promise = require('./promise')\n  , DocumentArray\n  , MongooseArray\n  , Embedded\n\n/**\n * Document constructor.\n *\n * @param {Object} obj the values to set\n * @param {Object} [fields] optional object containing the fields which were selected in the query returning this document and any populated paths data\n * @param {Boolean} [skipId] bool, should we auto create an ObjectId _id\n * @inherits NodeJS EventEmitter http://nodejs.org/api/events.html#events_class_events_eventemitter\n * @event `init`: Emitted on a document after it has was retreived from the db and fully hydrated by Mongoose.\n * @event `save`: Emitted when the document is successfully saved\n * @api private\n */\n\nfunction Document (obj, fields, skipId) {\n  this.$__ = new InternalCache;\n  this.$__.emitter = new EventEmitter();\n  this.isNew = true;\n  this.errors = undefined;\n\n  var schema = this.schema;\n\n  if ('boolean' === typeof fields) {\n    this.$__.strictMode = fields;\n    fields = undefined;\n  } else {\n    this.$__.strictMode = schema.options && schema.options.strict;\n    this.$__.selected = fields;\n  }\n\n  var required = schema.requiredPaths();\n  for (var i = 0; i < required.length; ++i) {\n    this.$__.activePaths.require(required[i]);\n  }\n\n  this.$__.emitter.setMaxListeners(0);\n  this._doc = this.$__buildDoc(obj, fields, skipId);\n\n  if (obj) {\n    this.set(obj, undefined, true);\n  }\n\n  if (!schema.options.strict && obj) {\n    var self = this\n      , keys = Object.keys(this._doc);\n\n    keys.forEach(function(key) {\n      if (!(key in schema.tree)) {\n        defineKey(key, null, self);\n      }\n    });\n  }\n\n  this.$__registerHooksFromSchema();\n}\n\n/*!\n * Document exposes the NodeJS event emitter API, so you can use\n * `on`, `once`, etc.\n */\nutils.each(\n  ['on', 'once', 'emit', 'listeners', 'removeListener', 'setMaxListeners',\n    'removeAllListeners', 'addListener'],\n  function(emitterFn) {\n    Document.prototype[emitterFn] = function() {\n      return this.$__.emitter[emitterFn].apply(this.$__.emitter, arguments);\n    };\n  });\n\nDocument.prototype.constructor = Document;\n\n/**\n * The documents schema.\n *\n * @api public\n * @property schema\n */\n\nDocument.prototype.schema;\n\n/**\n * Boolean flag specifying if the document is new.\n *\n * @api public\n * @property isNew\n */\n\nDocument.prototype.isNew;\n\n/**\n * The string version of this documents _id.\n *\n * ####Note:\n *\n * This getter exists on all documents by default. The getter can be disabled by setting the `id` [option](/docs/guide.html#id) of its `Schema` to false at construction time.\n *\n *     new Schema({ name: String }, { id: false });\n *\n * @api public\n * @see Schema options /docs/guide.html#options\n * @property id\n */\n\nDocument.prototype.id;\n\n/**\n * Hash containing current validation errors.\n *\n * @api public\n * @property errors\n */\n\nDocument.prototype.errors;\n\n/**\n * Builds the default doc structure\n *\n * @param {Object} obj\n * @param {Object} [fields]\n * @param {Boolean} [skipId]\n * @return {Object}\n * @api private\n * @method $__buildDoc\n * @memberOf Document\n */\n\nDocument.prototype.$__buildDoc = function (obj, fields, skipId) {\n  var doc = {}\n    , self = this\n    , exclude\n    , keys\n    , key\n    , ki\n\n  // determine if this doc is a result of a query with\n  // excluded fields\n  if (fields && 'Object' === utils.getFunctionName(fields.constructor)) {\n    keys = Object.keys(fields);\n    ki = keys.length;\n\n    while (ki--) {\n      if ('_id' !== keys[ki]) {\n        exclude = 0 === fields[keys[ki]];\n        break;\n      }\n    }\n  }\n\n  var paths = Object.keys(this.schema.paths)\n    , plen = paths.length\n    , ii = 0\n\n  for (; ii < plen; ++ii) {\n    var p = paths[ii];\n\n    if ('_id' == p) {\n      if (skipId) continue;\n      if (obj && '_id' in obj) continue;\n    }\n\n    var type = this.schema.paths[p];\n    var path = p.split('.');\n    var len = path.length;\n    var last = len - 1;\n    var curPath = '';\n    var doc_ = doc;\n    var i = 0;\n    var included = false;\n\n    for (; i < len; ++i) {\n      var piece = path[i]\n        , def\n\n      curPath += piece;\n\n      // support excluding intermediary levels\n      if (exclude) {\n        if (curPath in fields) break;\n      } else if (fields && curPath in fields) {\n        included = true;\n      }\n\n      if (i === last) {\n        if (fields) {\n          if (exclude) {\n            // apply defaults to all non-excluded fields\n            if (p in fields) continue;\n\n            def = type.getDefault(self, true);\n            if ('undefined' !== typeof def) {\n              doc_[piece] = def;\n              self.$__.activePaths.default(p);\n            }\n\n          } else if (included) {\n            // selected field\n            def = type.getDefault(self, true);\n            if ('undefined' !== typeof def) {\n              doc_[piece] = def;\n              self.$__.activePaths.default(p);\n            }\n          }\n        } else {\n          def = type.getDefault(self, true);\n          if ('undefined' !== typeof def) {\n            doc_[piece] = def;\n            self.$__.activePaths.default(p);\n          }\n        }\n      } else {\n        doc_ = doc_[piece] || (doc_[piece] = {});\n        curPath += '.';\n      }\n    }\n  }\n\n  return doc;\n};\n\n/**\n * Initializes the document without setters or marking anything modified.\n *\n * Called internally after a document is returned from mongodb.\n *\n * @param {Object} doc document returned by mongo\n * @param {Function} fn callback\n * @api private\n */\n\nDocument.prototype.init = function (doc, opts, fn) {\n  // do not prefix this method with $__ since its\n  // used by public hooks\n\n  if ('function' == typeof opts) {\n    fn = opts;\n    opts = null;\n  }\n\n  this.isNew = false;\n\n  // handle docs with populated paths\n  // If doc._id is not null or undefined\n  if (doc._id != null && opts && opts.populated && opts.populated.length) {\n    var id = String(doc._id);\n    for (var i = 0; i < opts.populated.length; ++i) {\n      var item = opts.populated[i];\n      this.populated(item.path, item._docs[id], item);\n    }\n  }\n\n  init(this, doc, this._doc);\n  this.$__storeShard();\n\n  this.emit('init', this);\n  if (fn) fn(null);\n  return this;\n};\n\n/*!\n * Init helper.\n *\n * @param {Object} self document instance\n * @param {Object} obj raw mongodb doc\n * @param {Object} doc object we are initializing\n * @api private\n */\n\nfunction init (self, obj, doc, prefix) {\n  prefix = prefix || '';\n\n  var keys = Object.keys(obj)\n    , len = keys.length\n    , schema\n    , path\n    , i;\n\n  while (len--) {\n    i = keys[len];\n    path = prefix + i;\n    schema = self.schema.path(path);\n\n    if (!schema && utils.isObject(obj[i]) &&\n        (!obj[i].constructor || 'Object' == utils.getFunctionName(obj[i].constructor))) {\n      // assume nested object\n      if (!doc[i]) doc[i] = {};\n      init(self, obj[i], doc[i], path + '.');\n    } else {\n      if (obj[i] === null) {\n        doc[i] = null;\n      } else if (obj[i] !== undefined) {\n        if (schema) {\n          try {\n            doc[i] = schema.cast(obj[i], self, true);\n          } catch (e) {\n            self.invalidate(e.path, new ValidatorError({\n              path: e.path,\n              message: e.message,\n              type: 'cast',\n              value: e.value\n            }));\n          }\n        } else {\n          doc[i] = obj[i];\n        }\n      }\n      // mark as hydrated\n      if (!self.isModified(path)) {\n        self.$__.activePaths.init(path);\n      }\n    }\n  }\n}\n\n/**\n * Stores the current values of the shard keys.\n *\n * ####Note:\n *\n * _Shard key values do not / are not allowed to change._\n *\n * @api private\n * @method $__storeShard\n * @memberOf Document\n */\n\nDocument.prototype.$__storeShard = function () {\n  // backwards compat\n  var key = this.schema.options.shardKey || this.schema.options.shardkey;\n  if (!(key && 'Object' == utils.getFunctionName(key.constructor))) return;\n\n  var orig = this.$__.shardval = {}\n    , paths = Object.keys(key)\n    , len = paths.length\n    , val\n\n  for (var i = 0; i < len; ++i) {\n    val = this.getValue(paths[i]);\n    if (isMongooseObject(val)) {\n      orig[paths[i]] = val.toObject({ depopulate: true })\n    } else if (null != val &&\n        val.valueOf &&\n        // Explicitly don't take value of dates\n        (!val.constructor || utils.getFunctionName(val.constructor) !== 'Date')) {\n      orig[paths[i]] = val.valueOf();\n    } else {\n      orig[paths[i]] = val;\n    }\n  }\n}\n\n/*!\n * Set up middleware support\n */\n\nfor (var k in hooks) {\n  Document.prototype[k] = Document[k] = hooks[k];\n}\n\n/**\n * Sends an update command with this document `_id` as the query selector.\n *\n * ####Example:\n *\n *     weirdCar.update({$inc: {wheels:1}}, { w: 1 }, callback);\n *\n * ####Valid options:\n *\n *  - same as in [Model.update](#model_Model.update)\n *\n * @see Model.update #model_Model.update\n * @param {Object} doc\n * @param {Object} options\n * @param {Function} callback\n * @return {Query}\n * @api public\n */\n\nDocument.prototype.update = function update () {\n  var args = utils.args(arguments);\n  args.unshift({_id: this._id});\n  return this.constructor.update.apply(this.constructor, args);\n}\n\n/**\n * Sets the value of a path, or many paths.\n *\n * ####Example:\n *\n *     // path, value\n *     doc.set(path, value)\n *\n *     // object\n *     doc.set({\n *         path  : value\n *       , path2 : {\n *            path  : value\n *         }\n *     })\n *\n *     // on-the-fly cast to number\n *     doc.set(path, value, Number)\n *\n *     // on-the-fly cast to string\n *     doc.set(path, value, String)\n *\n *     // changing strict mode behavior\n *     doc.set(path, value, { strict: false });\n *\n * @param {String|Object} path path or object of key/vals to set\n * @param {Any} val the value to set\n * @param {Schema|String|Number|Buffer|etc..} [type] optionally specify a type for \"on-the-fly\" attributes\n * @param {Object} [options] optionally specify options that modify the behavior of the set\n * @api public\n */\n\nDocument.prototype.set = function (path, val, type, options) {\n  if (type && 'Object' == utils.getFunctionName(type.constructor)) {\n    options = type;\n    type = undefined;\n  }\n\n  var merge = options && options.merge\n    , adhoc = type && true !== type\n    , constructing = true === type\n    , adhocs\n\n  var strict = options && 'strict' in options\n    ? options.strict\n    : this.$__.strictMode;\n\n  if (adhoc) {\n    adhocs = this.$__.adhocPaths || (this.$__.adhocPaths = {});\n    adhocs[path] = Schema.interpretAsType(path, type);\n  }\n\n  if ('string' !== typeof path) {\n    // new Document({ key: val })\n\n    if (null === path || undefined === path) {\n      var _ = path;\n      path = val;\n      val = _;\n\n    } else {\n      var prefix = val\n        ? val + '.'\n        : '';\n\n      if (path instanceof Document) path = path._doc;\n\n      var keys = Object.keys(path)\n        , i = keys.length\n        , pathtype\n        , key;\n\n      while (i--) {\n        key = keys[i];\n        var pathName = prefix + key;\n        pathtype = this.schema.pathType(pathName);\n        if (null != path[key]\n            // need to know if plain object - no Buffer, ObjectId, ref, etc\n            && utils.isObject(path[key])\n            && (!path[key].constructor || 'Object' == utils.getFunctionName(path[key].constructor))\n            && 'virtual' != pathtype\n            && !(this.$__path(pathName) instanceof MixedSchema)\n            && !(this.schema.paths[pathName] && this.schema.paths[pathName].options.ref)) {\n          this.set(path[key], prefix + key, constructing);\n        } else if (strict) {\n          if ('real' === pathtype || 'virtual' === pathtype) {\n            this.set(prefix + key, path[key], constructing);\n          } else if ('throw' == strict) {\n            throw new Error('Field `' + key + '` is not in schema.');\n          }\n        } else if (undefined !== path[key]) {\n          this.set(prefix + key, path[key], constructing);\n        }\n      }\n\n      return this;\n    }\n  }\n\n  // ensure _strict is honored for obj props\n  // docschema = new Schema({ path: { nest: 'string' }})\n  // doc.set('path', obj);\n  var pathType = this.schema.pathType(path);\n  if ('nested' == pathType && val) {\n    if (utils.isObject(val) &&\n        (!val.constructor || 'Object' == utils.getFunctionName(val.constructor))) {\n      if (!merge) this.setValue(path, null);\n      this.set(val, path, constructing);\n      return this;\n    }\n    this.invalidate(path, new MongooseError.CastError('Object', val, path));\n    return this;\n  }\n\n  var schema;\n  var parts = path.split('.');\n\n  if ('adhocOrUndefined' == pathType && strict) {\n\n    // check for roots that are Mixed types\n    var mixed;\n\n    for (var i = 0; i < parts.length; ++i) {\n      var subpath = parts.slice(0, i+1).join('.');\n      schema = this.schema.path(subpath);\n      if (schema instanceof MixedSchema) {\n        // allow changes to sub paths of mixed types\n        mixed = true;\n        break;\n      }\n    }\n\n    if (!mixed) {\n      if ('throw' == strict) {\n        throw new Error(\"Field `\" + path + \"` is not in schema.\");\n      }\n      return this;\n    }\n\n  } else if ('virtual' == pathType) {\n    schema = this.schema.virtualpath(path);\n    schema.applySetters(val, this);\n    return this;\n  } else {\n    schema = this.$__path(path);\n  }\n\n  var pathToMark;\n\n  // When using the $set operator the path to the field must already exist.\n  // Else mongodb throws: \"LEFT_SUBFIELD only supports Object\"\n\n  if (parts.length <= 1) {\n    pathToMark = path;\n  } else {\n    for (var i = 0; i < parts.length; ++i) {\n      var subpath = parts.slice(0, i+1).join('.');\n      if (this.isDirectModified(subpath) // earlier prefixes that are already\n                                         // marked as dirty have precedence\n          || this.get(subpath) === null) {\n        pathToMark = subpath;\n        break;\n      }\n    }\n\n    if (!pathToMark) pathToMark = path;\n  }\n\n  // if this doc is being constructed we should not trigger getters\n  var priorVal = constructing\n    ? undefined\n    : this.getValue(path);\n\n  if (!schema) {\n    this.$__set(pathToMark, path, constructing, parts, schema, val, priorVal);\n    return this;\n  }\n\n  var shouldSet = true;\n  try {\n    // If the user is trying to set a ref path to a document with\n    // the correct model name, treat it as populated\n    if (schema.options &&\n        schema.options.ref &&\n        val instanceof Document &&\n        schema.options.ref === val.constructor.modelName) {\n      this.populated(path, val._id);\n    }\n    val = schema.applySetters(val, this, false, priorVal);\n    this.$markValid(path);\n  } catch (e) {\n    this.invalidate(path,\n      new MongooseError.CastError(schema.instance, val, path));\n    shouldSet = false;\n  }\n\n  if (shouldSet) {\n    this.$__set(pathToMark, path, constructing, parts, schema, val, priorVal);\n  }\n\n  return this;\n}\n\n/**\n * Determine if we should mark this change as modified.\n *\n * @return {Boolean}\n * @api private\n * @method $__shouldModify\n * @memberOf Document\n */\n\nDocument.prototype.$__shouldModify = function (\n    pathToMark, path, constructing, parts, schema, val, priorVal) {\n\n  if (this.isNew) return true;\n\n  if (undefined === val && !this.isSelected(path)) {\n    // when a path is not selected in a query, its initial\n    // value will be undefined.\n    return true;\n  }\n\n  if (undefined === val && path in this.$__.activePaths.states.default) {\n    // we're just unsetting the default value which was never saved\n    return false;\n  }\n\n  if (!deepEqual(val, priorVal || this.get(path))) {\n    return true;\n  }\n\n  if (!constructing &&\n      null != val &&\n      path in this.$__.activePaths.states.default &&\n      deepEqual(val, schema.getDefault(this, constructing))) {\n    // a path with a default was $unset on the server\n    // and the user is setting it to the same value again\n    return true;\n  }\n  return false;\n}\n\n/**\n * Handles the actual setting of the value and marking the path modified if appropriate.\n *\n * @api private\n * @method $__set\n * @memberOf Document\n */\n\nDocument.prototype.$__set = function (\n    pathToMark, path, constructing, parts, schema, val, priorVal) {\n  Embedded = Embedded || require('./types/embedded');\n\n  var shouldModify = this.$__shouldModify.apply(this, arguments);\n  var _this = this;\n\n  if (shouldModify) {\n    this.markModified(pathToMark, val);\n\n    // handle directly setting arrays (gh-1126)\n    MongooseArray || (MongooseArray = require('./types/array'));\n    if (val && val.isMongooseArray) {\n      val._registerAtomic('$set', val);\n\n      // Small hack for gh-1638: if we're overwriting the entire array, ignore\n      // paths that were modified before the array overwrite\n      this.$__.activePaths.forEach(function(modifiedPath) {\n        if (modifiedPath.indexOf(path + '.') === 0) {\n          _this.$__.activePaths.ignore(modifiedPath);\n        }\n      });\n    }\n  }\n\n  var obj = this._doc\n    , i = 0\n    , l = parts.length\n\n  for (; i < l; i++) {\n    var next = i + 1\n      , last = next === l;\n\n    if (last) {\n      obj[parts[i]] = val;\n    } else {\n      if (obj[parts[i]] && 'Object' === utils.getFunctionName(obj[parts[i]].constructor)) {\n        obj = obj[parts[i]];\n      } else if (obj[parts[i]] && obj[parts[i]] instanceof Embedded) {\n        obj = obj[parts[i]];\n      } else if (obj[parts[i]] && Array.isArray(obj[parts[i]])) {\n        obj = obj[parts[i]];\n      } else {\n        obj = obj[parts[i]] = {};\n      }\n    }\n  }\n}\n\n/**\n * Gets a raw value from a path (no getters)\n *\n * @param {String} path\n * @api private\n */\n\nDocument.prototype.getValue = function (path) {\n  return utils.getValue(path, this._doc);\n}\n\n/**\n * Sets a raw value for a path (no casting, setters, transformations)\n *\n * @param {String} path\n * @param {Object} value\n * @api private\n */\n\nDocument.prototype.setValue = function (path, val) {\n  utils.setValue(path, val, this._doc);\n  return this;\n}\n\n/**\n * Returns the value of a path.\n *\n * ####Example\n *\n *     // path\n *     doc.get('age') // 47\n *\n *     // dynamic casting to a string\n *     doc.get('age', String) // \"47\"\n *\n * @param {String} path\n * @param {Schema|String|Number|Buffer|etc..} [type] optionally specify a type for on-the-fly attributes\n * @api public\n */\n\nDocument.prototype.get = function (path, type) {\n  var adhoc;\n  if (type) {\n    adhoc = Schema.interpretAsType(path, type);\n  }\n\n  var schema = this.$__path(path) || this.schema.virtualpath(path)\n    , pieces = path.split('.')\n    , obj = this._doc;\n\n  for (var i = 0, l = pieces.length; i < l; i++) {\n    obj = undefined === obj || null === obj\n      ? undefined\n      : obj[pieces[i]];\n  }\n\n  if (adhoc) {\n    obj = adhoc.cast(obj);\n  }\n\n  if (schema) {\n    obj = schema.applyGetters(obj, this);\n  }\n\n  return obj;\n};\n\n/**\n * Returns the schematype for the given `path`.\n *\n * @param {String} path\n * @api private\n * @method $__path\n * @memberOf Document\n */\n\nDocument.prototype.$__path = function (path) {\n  var adhocs = this.$__.adhocPaths\n    , adhocType = adhocs && adhocs[path];\n\n  if (adhocType) {\n    return adhocType;\n  } else {\n    return this.schema.path(path);\n  }\n};\n\n/**\n * Marks the path as having pending changes to write to the db.\n *\n * _Very helpful when using [Mixed](./schematypes.html#mixed) types._\n *\n * ####Example:\n *\n *     doc.mixed.type = 'changed';\n *     doc.markModified('mixed.type');\n *     doc.save() // changes to mixed.type are now persisted\n *\n * @param {String} path the path to mark modified\n * @api public\n */\n\nDocument.prototype.markModified = function (path) {\n  this.$__.activePaths.modify(path);\n}\n\n/**\n * Returns the list of paths that have been modified.\n *\n * @return {Array}\n * @api public\n */\n\nDocument.prototype.modifiedPaths = function () {\n  var directModifiedPaths = Object.keys(this.$__.activePaths.states.modify);\n\n  return directModifiedPaths.reduce(function (list, path) {\n    var parts = path.split('.');\n    return list.concat(parts.reduce(function (chains, part, i) {\n      return chains.concat(parts.slice(0, i).concat(part).join('.'));\n    }, []));\n  }, []);\n};\n\n/**\n * Returns true if this document was modified, else false.\n *\n * If `path` is given, checks if a path or any full path containing `path` as part of its path chain has been modified.\n *\n * ####Example\n *\n *     doc.set('documents.0.title', 'changed');\n *     doc.isModified()                    // true\n *     doc.isModified('documents')         // true\n *     doc.isModified('documents.0.title') // true\n *     doc.isDirectModified('documents')   // false\n *\n * @param {String} [path] optional\n * @return {Boolean}\n * @api public\n */\n\nDocument.prototype.isModified = function (path) {\n  return path\n    ? !!~this.modifiedPaths().indexOf(path)\n    : this.$__.activePaths.some('modify');\n};\n\n/**\n * Returns true if `path` was directly set and modified, else false.\n *\n * ####Example\n *\n *     doc.set('documents.0.title', 'changed');\n *     doc.isDirectModified('documents.0.title') // true\n *     doc.isDirectModified('documents') // false\n *\n * @param {String} path\n * @return {Boolean}\n * @api public\n */\n\nDocument.prototype.isDirectModified = function (path) {\n  return (path in this.$__.activePaths.states.modify);\n};\n\n/**\n * Checks if `path` was initialized.\n *\n * @param {String} path\n * @return {Boolean}\n * @api public\n */\n\nDocument.prototype.isInit = function (path) {\n  return (path in this.$__.activePaths.states.init);\n};\n\n/**\n * Checks if `path` was selected in the source query which initialized this document.\n *\n * ####Example\n *\n *     Thing.findOne().select('name').exec(function (err, doc) {\n *        doc.isSelected('name') // true\n *        doc.isSelected('age')  // false\n *     })\n *\n * @param {String} path\n * @return {Boolean}\n * @api public\n */\n\nDocument.prototype.isSelected = function isSelected (path) {\n  if (this.$__.selected) {\n\n    if ('_id' === path) {\n      return 0 !== this.$__.selected._id;\n    }\n\n    var paths = Object.keys(this.$__.selected)\n      , i = paths.length\n      , inclusive = false\n      , cur\n\n    if (1 === i && '_id' === paths[0]) {\n      // only _id was selected.\n      return 0 === this.$__.selected._id;\n    }\n\n    while (i--) {\n      cur = paths[i];\n      if ('_id' == cur) continue;\n      inclusive = !! this.$__.selected[cur];\n      break;\n    }\n\n    if (path in this.$__.selected) {\n      return inclusive;\n    }\n\n    i = paths.length;\n    var pathDot = path + '.';\n\n    while (i--) {\n      cur = paths[i];\n      if ('_id' == cur) continue;\n\n      if (0 === cur.indexOf(pathDot)) {\n        return inclusive;\n      }\n\n      if (0 === pathDot.indexOf(cur + '.')) {\n        return inclusive;\n      }\n    }\n\n    return ! inclusive;\n  }\n\n  return true;\n};\n\n/**\n * Executes registered validation rules for this document.\n *\n * ####Note:\n *\n * This method is called `pre` save and if a validation rule is violated, [save](#model_Model-save) is aborted and the error is returned to your `callback`.\n *\n * ####Example:\n *\n *     doc.validate(function (err) {\n *       if (err) handleError(err);\n *       else // validation passed\n *     });\n *\n * @param {Function} optional cb called after validation completes, passing an error if one occurred\n * @return {Promise} Promise\n * @api public\n */\n\nDocument.prototype.validate = function (cb) {\n  var self = this;\n  var promise = new Promise(cb);\n\n  // only validate required fields when necessary\n  var paths = Object.keys(this.$__.activePaths.states.require).filter(function (path) {\n    if (!self.isSelected(path) && !self.isModified(path)) return false;\n    return true;\n  });\n\n  paths = paths.concat(Object.keys(this.$__.activePaths.states.init));\n  paths = paths.concat(Object.keys(this.$__.activePaths.states.modify));\n  paths = paths.concat(Object.keys(this.$__.activePaths.states.default));\n\n  if (0 === paths.length) {\n    process.nextTick(function() {\n      complete();\n    });\n    return promise;\n  }\n\n  var validating = {}\n    , total = 0;\n\n  // gh-661: if a whole array is modified, make sure to run validation on all\n  // the children as well\n  for (var i = 0; i < paths.length; ++i) {\n    var path = paths[i];\n    var val = self.getValue(path);\n    if (val instanceof Array && !Buffer.isBuffer(val) &&\n        !val.isMongooseDocumentArray) {\n      var numElements = val.length;\n      for (var j = 0; j < numElements; ++j) {\n        paths.push(path + '.' + j);\n      }\n    }\n  }\n  paths.forEach(validatePath);\n  return promise;\n\n  function validatePath (path) {\n    if (validating[path]) return;\n\n    validating[path] = true;\n    total++;\n\n    process.nextTick(function(){\n      var p = self.schema.path(path);\n      if (!p) {\n        return --total || complete();\n      }\n\n      // If user marked as invalid or there was a cast error, don't validate\n      if (!self.$isValid(path)) {\n        --total || complete();\n        return;\n      }\n\n      var val = self.getValue(path);\n      p.doValidate(val, function (err) {\n        if (err) {\n          self.invalidate(path, err, undefined, true);\n        }\n        --total || complete();\n      }, self);\n    });\n  }\n\n  function complete () {\n    var err = self.$__.validationError;\n    self.$__.validationError = undefined;\n    self.emit('validate', self);\n    if (err) {\n      for (var key in err.errors) {\n        // Make sure cast errors persist\n        if (!self.__parent && err.errors[key] instanceof MongooseError.CastError) {\n          self.invalidate(key, err.errors[key]);\n        }\n      }\n      promise.reject(err);\n    } else {\n      promise.fulfill();\n    }\n  }\n};\n\n/**\n * Executes registered validation rules (skipping asynchronous validators) for this document.\n *\n * ####Note:\n *\n * This method is useful if you need synchronous validation.\n *\n * ####Example:\n *\n *     var err = doc.validateSync();\n *     if ( err ){\n *       handleError( err );\n *     } else {\n *       // validation passed\n *     }\n *\n * @return {MongooseError|undefined} MongooseError if there are errors during validation, or undefined if there is no error.\n * @api public\n */\n\nDocument.prototype.validateSync = function () {\n  var self = this;\n\n  // only validate required fields when necessary\n  var paths = Object.keys(this.$__.activePaths.states.require).filter(function (path) {\n    if (!self.isSelected(path) && !self.isModified(path)) return false;\n    return true;\n  });\n\n  paths = paths.concat(Object.keys(this.$__.activePaths.states.init));\n  paths = paths.concat(Object.keys(this.$__.activePaths.states.modify));\n  paths = paths.concat(Object.keys(this.$__.activePaths.states.default));\n\n  var validating = {};\n\n  paths.forEach(function (path) {\n    if (validating[path]) return;\n\n    validating[path] = true;\n\n    var p = self.schema.path(path);\n    if (!p) return;\n    if (!self.$isValid(path)) {\n      return;\n    }\n\n    var val = self.getValue(path);\n    var err = p.doValidateSync(val, self);\n    if (err) {\n      self.invalidate(path, err, undefined, true);\n    }\n  });\n\n  var err = self.$__.validationError;\n  self.$__.validationError = undefined;\n  self.emit('validate', self);\n\n  if (err) {\n    for (var key in err.errors) {\n      // Make sure cast errors persist\n      if (err.errors[key] instanceof MongooseError.CastError) {\n        self.invalidate(key, err.errors[key]);\n      }\n    }\n  }\n\n  return err;\n};\n\n/**\n * Marks a path as invalid, causing validation to fail.\n *\n * The `errorMsg` argument will become the message of the `ValidationError`.\n *\n * The `value` argument (if passed) will be available through the `ValidationError.value` property.\n *\n *     doc.invalidate('size', 'must be less than 20', 14);\n\n *     doc.validate(function (err) {\n *       console.log(err)\n *       // prints\n *       { message: 'Validation failed',\n *         name: 'ValidationError',\n *         errors:\n *          { size:\n *             { message: 'must be less than 20',\n *               name: 'ValidatorError',\n *               path: 'size',\n *               type: 'user defined',\n *               value: 14 } } }\n *     })\n *\n * @param {String} path the field to invalidate\n * @param {String|Error} errorMsg the error which states the reason `path` was invalid\n * @param {Object|String|Number|any} value optional invalid value\n * @api public\n */\n\nDocument.prototype.invalidate = function (path, err, val) {\n  if (!this.$__.validationError) {\n    this.$__.validationError = new ValidationError(this);\n  }\n\n  if (this.$__.validationError.errors[path]) return;\n\n  if (!err || 'string' === typeof err) {\n    err = new ValidatorError({\n      path: path,\n      message: err,\n      type: 'user defined',\n      value: val\n    });\n  }\n\n  if (this.$__.validationError == err) return;\n\n  this.$__.validationError.errors[path] = err;\n};\n\n/**\n * Marks a path as valid, removing existing validation errors.\n *\n * @param {String} path the field to mark as valid\n * @api private\n * @method $markValid\n * @receiver Document\n */\n\nDocument.prototype.$markValid = function(path) {\n  if (!this.$__.validationError || !this.$__.validationError.errors[path]) {\n    return;\n  }\n\n  delete this.$__.validationError.errors[path];\n  if (Object.keys(this.$__.validationError.errors).length === 0) {\n    this.$__.validationError = null;\n  }\n};\n\n/**\n * Checks if a path is invalid\n *\n * @param {String} path the field to check\n * @method $isValid\n * @api private\n * @receiver Document\n */\n\nDocument.prototype.$isValid = function(path) {\n  return !this.$__.validationError || !this.$__.validationError.errors[path];\n};\n\n/**\n * Resets the internal modified state of this document.\n *\n * @api private\n * @return {Document}\n * @method $__reset\n * @memberOf Document\n */\n\nDocument.prototype.$__reset = function reset () {\n  var self = this;\n  DocumentArray || (DocumentArray = require('./types/documentarray'));\n\n  this.$__.activePaths\n  .map('init', 'modify', function (i) {\n    return self.getValue(i);\n  })\n  .filter(function (val) {\n    return val && val instanceof Array && val.isMongooseDocumentArray && val.length;\n  })\n  .forEach(function (array) {\n    var i = array.length;\n    while (i--) {\n      var doc = array[i];\n      if (!doc) continue;\n      doc.$__reset();\n    }\n  });\n\n  // clear atomics\n  this.$__dirty().forEach(function (dirt) {\n    var type = dirt.value;\n    if (type && type._atomics) {\n      type._atomics = {};\n    }\n  });\n\n  // Clear 'modify'('dirty') cache\n  this.$__.activePaths.clear('modify');\n  this.$__.validationError = undefined;\n  this.errors = undefined;\n  var self = this;\n  this.schema.requiredPaths().forEach(function (path) {\n    self.$__.activePaths.require(path);\n  });\n\n  return this;\n}\n\n/**\n * Returns this documents dirty paths / vals.\n *\n * @api private\n * @method $__dirty\n * @memberOf Document\n */\n\nDocument.prototype.$__dirty = function () {\n  var self = this;\n\n  var all = this.$__.activePaths.map('modify', function (path) {\n    return {\n      path: path,\n      value: self.getValue(path),\n      schema: self.$__path(path)\n    };\n  });\n\n  // gh-2558: if we had to set a default and the value is not undefined,\n  // we have to save as well\n  all = all.concat(this.$__.activePaths.map('default', function (path) {\n    if (path === '_id' || !self.getValue(path)) {\n      return;\n    }\n    return {\n      path: path,\n      value: self.getValue(path),\n      schema: self.$__path(path)\n    };\n  }));\n\n  // Sort dirty paths in a flat hierarchy.\n  all.sort(function (a, b) {\n    return (a.path < b.path ? -1 : (a.path > b.path ? 1 : 0));\n  });\n\n  // Ignore \"foo.a\" if \"foo\" is dirty already.\n  var minimal = []\n    , lastPath\n    , top;\n\n  all.forEach(function (item, i) {\n    if (!item) {\n      return;\n    }\n    if (item.path.indexOf(lastPath) !== 0) {\n      lastPath = item.path + '.';\n      minimal.push(item);\n      top = item;\n    } else {\n      // special case for top level MongooseArrays\n      if (top.value && top.value._atomics && top.value.hasAtomics()) {\n        // the `top` array itself and a sub path of `top` are being modified.\n        // the only way to honor all of both modifications is through a $set\n        // of entire array.\n        top.value._atomics = {};\n        top.value._atomics.$set = top.value;\n      }\n    }\n  });\n\n  top = lastPath = null;\n  return minimal;\n}\n\n/*!\n * Compiles schemas.\n */\n\nfunction compile (tree, proto, prefix) {\n  var keys = Object.keys(tree)\n    , i = keys.length\n    , limb\n    , key;\n\n  while (i--) {\n    key = keys[i];\n    limb = tree[key];\n\n    defineKey(key\n        , (('Object' === utils.getFunctionName(limb.constructor)\n               && Object.keys(limb).length)\n               && (!limb.type || limb.type.type)\n               ? limb\n               : null)\n        , proto\n        , prefix\n        , keys);\n  }\n};\n\n// gets descriptors for all properties of `object`\n// makes all properties non-enumerable to match previous behavior to #2211\nfunction getOwnPropertyDescriptors(object) {\n  var result = {};\n\n  Object.getOwnPropertyNames(object).forEach(function(key) {\n    result[key] = Object.getOwnPropertyDescriptor(object, key);\n    result[key].enumerable = true;\n  });\n\n  return result;\n}\n\n/*!\n * Defines the accessor named prop on the incoming prototype.\n */\n\nfunction defineKey (prop, subprops, prototype, prefix, keys) {\n  var prefix = prefix || ''\n    , path = (prefix ? prefix + '.' : '') + prop;\n\n  if (subprops) {\n\n    Object.defineProperty(prototype, prop, {\n        enumerable: true\n      , configurable: true\n      , get: function () {\n          if (!this.$__.getters)\n            this.$__.getters = {};\n\n          if (!this.$__.getters[path]) {\n            var nested = Object.create(Object.getPrototypeOf(this), getOwnPropertyDescriptors(this));\n\n            // save scope for nested getters/setters\n            if (!prefix) nested.$__.scope = this;\n\n            // shadow inherited getters from sub-objects so\n            // thing.nested.nested.nested... doesn't occur (gh-366)\n            var i = 0\n              , len = keys.length;\n\n            for (; i < len; ++i) {\n              // over-write the parents getter without triggering it\n              Object.defineProperty(nested, keys[i], {\n                  enumerable: false   // It doesn't show up.\n                , writable: true      // We can set it later.\n                , configurable: true  // We can Object.defineProperty again.\n                , value: undefined    // It shadows its parent.\n              });\n            }\n\n            nested.toObject = function() {\n              return this.get(path);\n            };\n\n            nested.toJSON = nested.toObject;\n\n            compile(subprops, nested, path);\n            this.$__.getters[path] = nested;\n          }\n\n          return this.$__.getters[path];\n        }\n      , set: function (v) {\n          if (v instanceof Document) v = v.toObject();\n          return (this.$__.scope || this).set(path, v);\n        }\n    });\n\n  } else {\n    Object.defineProperty(prototype, prop, {\n        enumerable: true\n      , configurable: true\n      , get: function ( ) { return this.get.call(this.$__.scope || this, path); }\n      , set: function (v) { return this.set.call(this.$__.scope || this, path, v); }\n    });\n  }\n}\n\n/**\n * Assigns/compiles `schema` into this documents prototype.\n *\n * @param {Schema} schema\n * @api private\n * @method $__setSchema\n * @memberOf Document\n */\n\nDocument.prototype.$__setSchema = function (schema) {\n  compile(schema.tree, this);\n  this.schema = schema;\n};\n\n\n/**\n * Get active path that were changed and are arrays\n *\n * @api private\n * @method $__getArrayPathsToValidate\n * @memberOf Document\n */\n\nDocument.prototype.$__getArrayPathsToValidate = function () {\n  DocumentArray || (DocumentArray = require('./types/documentarray'));\n\n  // validate all document arrays.\n  return this.$__.activePaths\n    .map('init', 'modify', function (i) {\n      return this.getValue(i);\n    }.bind(this))\n    .filter(function (val) {\n      return val && val instanceof Array && val.isMongooseDocumentArray && val.length;\n    }).reduce(function(seed, array) {\n      return seed.concat(array);\n    }, [])\n    .filter(function (doc) {return doc});\n};\n\n\n/**\n * Get all subdocs (by bfs)\n *\n * @api private\n * @method $__getAllSubdocs\n * @memberOf Document\n */\n\nDocument.prototype.$__getAllSubdocs = function () {\n  DocumentArray || (DocumentArray = require('./types/documentarray'));\n  Embedded = Embedded || require('./types/embedded');\n\n  function docReducer(seed, path) {\n    var val = this[path];\n    if (val instanceof Embedded) seed.push(val);\n    if (val && val.isMongooseDocumentArray) {\n      val.forEach(function _docReduce(doc) {\n        if (!doc || !doc._doc) return;\n        if (doc instanceof Embedded) seed.push(doc);\n        seed = Object.keys(doc._doc).reduce(docReducer.bind(doc._doc), seed);\n      });\n    }\n    return seed;\n  }\n\n  var subDocs = Object.keys(this._doc).reduce(docReducer.bind(this), []);\n\n  return subDocs;\n};\n\n/**\n * Executes methods queued from the Schema definition\n *\n * @api private\n * @method $__registerHooksFromSchema\n * @memberOf Document\n */\n\nDocument.prototype.$__registerHooksFromSchema = function () {\n  Embedded = Embedded || require('./types/embedded');\n\n  var self = this;\n  var q = self.schema && self.schema.callQueue;\n  if (!q.length) return self;\n\n  // we are only interested in 'pre' hooks, and group by point-cut\n  var toWrap = q.reduce(function (seed, pair) {\n    if (pair[0] !== 'pre' && pair[0] !== 'post' && pair[0] !== 'on') {\n      self[pair[0]].apply(self, pair[1]);\n      return seed;\n    }\n    var args = [].slice.call(pair[1]);\n    var pointCut = pair[0] === 'on' ? 'post' : args[0];\n    if (!(pointCut in seed)) seed[pointCut] = [];\n    seed[pointCut].push(args);\n    return seed;\n  }, {post: []});\n\n  // 'post' hooks are simpler\n  toWrap.post.forEach(function (args) {\n    self.on.apply(self, args);\n  });\n  delete toWrap.post;\n\n  Object.keys(toWrap).forEach(function (pointCut) {\n\n    // skip weird handlers\n    if (~\"set \".indexOf(pointCut)) {\n      toWrap[pointCut].forEach(function (args) {\n        self.pre.apply(self, args);\n      });\n      return;\n    }\n\n    // this is so we can wrap everything into a promise;\n    var newName = ('$__original_' + pointCut);\n    if (!self[pointCut]) {\n      return;\n    }\n    self[newName] = self[pointCut];\n    self[pointCut] = function wrappedPointCut () {\n      var args = [].slice.call(arguments);\n      var lastArg = args.pop();\n\n      var wrapingPromise = new Promise;\n      wrapingPromise.end();\n      if (typeof lastArg == 'function') {\n        wrapingPromise.onResolve(lastArg);\n      }\n      if (!(this instanceof Embedded) && !wrapingPromise.hasRejectListeners()) {\n        wrapingPromise.onReject(self.$__handleReject.bind(self));\n      }\n      args.push(function () {\n        return wrapingPromise.resolve.apply(wrapingPromise, arguments);\n      });\n\n      // fire original\n      self[newName].apply(self, args);\n      return wrapingPromise;\n    };\n\n    toWrap[pointCut].forEach(function (args) {\n      args[0] = newName;\n      self.pre.apply(self, args);\n    });\n  })\n  return self;\n};\n\n\nDocument.prototype.$__handleReject = function handleReject(err) {\n  // emit on the Model if listening\n  if (this.listeners('error').length) {\n    this.emit('error', err);\n  } else if (this.constructor.listeners && this.constructor.listeners('error').length) {\n    this.constructor.emit('error', err);\n  } else if (this.listeners && this.listeners('error').length) {\n    this.emit('error', err);\n  }\n};\n\n\n\n/**\n * Internal helper for toObject() and toJSON() that doesn't manipulate options\n *\n * @api private\n * @method $toObject\n * @memberOf Document\n */\n\nDocument.prototype.$toObject = function(options, json) {\n  var defaultOptions = { transform: true, json: json };\n\n  if (options && options.depopulate && !options._skipDepopulateTopLevel && this.$__.wasPopulated) {\n    // populated paths that we set to a document\n    return clone(this._id, options);\n  }\n\n  // If we're calling toObject on a populated doc, we may want to skip\n  // depopulated on the top level\n  if (options && options._skipDepopulateTopLevel) {\n    options._skipDepopulateTopLevel = false;\n  }\n\n  // When internally saving this document we always pass options,\n  // bypassing the custom schema options.\n  var optionsParameter = options;\n  if (!(options && 'Object' == utils.getFunctionName(options.constructor)) ||\n      (options && options._useSchemaOptions)) {\n    if (json) {\n      options = this.schema.options.toJSON ?\n        clone(this.schema.options.toJSON) :\n        {};\n    } else {\n      options = this.schema.options.toObject ?\n        clone(this.schema.options.toObject) :\n        {};\n    }\n  }\n\n  for (var key in defaultOptions) {\n    if (options[key] === undefined) {\n      options[key] = defaultOptions[key];\n    }\n  }\n\n  ;('minimize' in options) || (options.minimize = this.schema.options.minimize);\n  if (!optionsParameter) {\n    options._useSchemaOptions = true;\n  }\n\n  // remember the root transform function\n  // to save it from being overwritten by sub-transform functions\n  var originalTransform = options.transform;\n\n  var ret = clone(this._doc, options);\n\n  if (options.virtuals || options.getters && false !== options.virtuals) {\n    applyGetters(this, ret, 'virtuals', options);\n  }\n\n  if (options.getters) {\n    applyGetters(this, ret, 'paths', options);\n    // applyGetters for paths will add nested empty objects;\n    // if minimize is set, we need to remove them.\n    if (options.minimize) {\n      ret = minimize(ret) || {};\n    }\n  }\n\n  if (options.versionKey === false && this.schema.options.versionKey) {\n    delete ret[this.schema.options.versionKey];\n  }\n\n  var transform = options.transform;\n\n  // In the case where a subdocument has its own transform function, we need to\n  // check and see if the parent has a transform (options.transform) and if the\n  // child schema has a transform (this.schema.options.toObject) In this case,\n  // we need to adjust options.transform to be the child schema's transform and\n  // not the parent schema's\n  if (true === transform ||\n      (this.schema.options.toObject && transform)) {\n\n    var opts = options.json ? this.schema.options.toJSON : this.schema.options.toObject;\n\n    if (opts) {\n      transform = (typeof options.transform === 'function' ? options.transform : opts.transform);\n    }\n  } else {\n    options.transform = originalTransform;\n  }\n\n  if ('function' == typeof transform) {\n    var xformed = transform(this, ret, options);\n    if ('undefined' != typeof xformed) ret = xformed;\n  }\n\n  return ret;\n};\n\n/**\n * Converts this document into a plain javascript object, ready for storage in MongoDB.\n *\n * Buffers are converted to instances of [mongodb.Binary](http://mongodb.github.com/node-mongodb-native/api-bson-generated/binary.html) for proper storage.\n *\n * ####Options:\n *\n * - `getters` apply all getters (path and virtual getters)\n * - `virtuals` apply virtual getters (can override `getters` option)\n * - `minimize` remove empty objects (defaults to true)\n * - `transform` a transform function to apply to the resulting document before returning\n * - `depopulate` depopulate any populated paths, replacing them with their original refs (defaults to false)\n * - `versionKey` whether to include the version key (defaults to true)\n * - `retainKeyOrder` keep the order of object keys. If this is set to true, `Object.keys(new Doc({ a: 1, b: 2}).toObject())` will always produce `['a', 'b']` (defaults to false)\n *\n * ####Getters/Virtuals\n *\n * Example of only applying path getters\n *\n *     doc.toObject({ getters: true, virtuals: false })\n *\n * Example of only applying virtual getters\n *\n *     doc.toObject({ virtuals: true })\n *\n * Example of applying both path and virtual getters\n *\n *     doc.toObject({ getters: true })\n *\n * To apply these options to every document of your schema by default, set your [schemas](#schema_Schema) `toObject` option to the same argument.\n *\n *     schema.set('toObject', { virtuals: true })\n *\n * ####Transform\n *\n * We may need to perform a transformation of the resulting object based on some criteria, say to remove some sensitive information or return a custom object. In this case we set the optional `transform` function.\n *\n * Transform functions receive three arguments\n *\n *     function (doc, ret, options) {}\n *\n * - `doc` The mongoose document which is being converted\n * - `ret` The plain object representation which has been converted\n * - `options` The options in use (either schema options or the options passed inline)\n *\n * ####Example\n *\n *     // specify the transform schema option\n *     if (!schema.options.toObject) schema.options.toObject = {};\n *     schema.options.toObject.transform = function (doc, ret, options) {\n *       // remove the _id of every document before returning the result\n *       delete ret._id;\n *     }\n *\n *     // without the transformation in the schema\n *     doc.toObject(); // { _id: 'anId', name: 'Wreck-it Ralph' }\n *\n *     // with the transformation\n *     doc.toObject(); // { name: 'Wreck-it Ralph' }\n *\n * With transformations we can do a lot more than remove properties. We can even return completely new customized objects:\n *\n *     if (!schema.options.toObject) schema.options.toObject = {};\n *     schema.options.toObject.transform = function (doc, ret, options) {\n *       return { movie: ret.name }\n *     }\n *\n *     // without the transformation in the schema\n *     doc.toObject(); // { _id: 'anId', name: 'Wreck-it Ralph' }\n *\n *     // with the transformation\n *     doc.toObject(); // { movie: 'Wreck-it Ralph' }\n *\n * _Note: if a transform function returns `undefined`, the return value will be ignored._\n *\n * Transformations may also be applied inline, overridding any transform set in the options:\n *\n *     function xform (doc, ret, options) {\n *       return { inline: ret.name, custom: true }\n *     }\n *\n *     // pass the transform as an inline option\n *     doc.toObject({ transform: xform }); // { inline: 'Wreck-it Ralph', custom: true }\n *\n * _Note: if you call `toObject` and pass any options, the transform declared in your schema options will __not__ be applied. To force its application pass `transform: true`_\n *\n *     if (!schema.options.toObject) schema.options.toObject = {};\n *     schema.options.toObject.hide = '_id';\n *     schema.options.toObject.transform = function (doc, ret, options) {\n *       if (options.hide) {\n *         options.hide.split(' ').forEach(function (prop) {\n *           delete ret[prop];\n *         });\n *       }\n *     }\n *\n *     var doc = new Doc({ _id: 'anId', secret: 47, name: 'Wreck-it Ralph' });\n *     doc.toObject();                                        // { secret: 47, name: 'Wreck-it Ralph' }\n *     doc.toObject({ hide: 'secret _id' });                  // { _id: 'anId', secret: 47, name: 'Wreck-it Ralph' }\n *     doc.toObject({ hide: 'secret _id', transform: true }); // { name: 'Wreck-it Ralph' }\n *\n * Transforms are applied _only to the document and are not applied to sub-documents_.\n *\n * Transforms, like all of these options, are also available for `toJSON`.\n *\n * See [schema options](/docs/guide.html#toObject) for some more details.\n *\n * _During save, no custom options are applied to the document before being sent to the database._\n *\n * @param {Object} [options]\n * @return {Object} js object\n * @see mongodb.Binary http://mongodb.github.com/node-mongodb-native/api-bson-generated/binary.html\n * @api public\n */\n\nDocument.prototype.toObject = function (options) {\n  return this.$toObject(options);\n};\n\n/*!\n * Minimizes an object, removing undefined values and empty objects\n *\n * @param {Object} object to minimize\n * @return {Object}\n */\n\nfunction minimize (obj) {\n  var keys = Object.keys(obj)\n    , i = keys.length\n    , hasKeys\n    , key\n    , val\n\n  while (i--) {\n    key = keys[i];\n    val = obj[key];\n\n    if (utils.isObject(val)) {\n      obj[key] = minimize(val);\n    }\n\n    if (undefined === obj[key]) {\n      delete obj[key];\n      continue;\n    }\n\n    hasKeys = true;\n  }\n\n  return hasKeys\n    ? obj\n    : undefined;\n}\n\n/*!\n * Applies virtuals properties to `json`.\n *\n * @param {Document} self\n * @param {Object} json\n * @param {String} type either `virtuals` or `paths`\n * @return {Object} `json`\n */\n\nfunction applyGetters (self, json, type, options) {\n  var schema = self.schema\n    , paths = Object.keys(schema[type])\n    , i = paths.length\n    , path\n\n  while (i--) {\n    path = paths[i];\n\n    var parts = path.split('.')\n      , plen = parts.length\n      , last = plen - 1\n      , branch = json\n      , part\n\n    for (var ii = 0; ii < plen; ++ii) {\n      part = parts[ii];\n      if (ii === last) {\n        branch[part] = clone(self.get(path), options);\n      } else {\n        branch = branch[part] || (branch[part] = {});\n      }\n    }\n  }\n\n  return json;\n}\n\n/**\n * The return value of this method is used in calls to JSON.stringify(doc).\n *\n * This method accepts the same options as [Document#toObject](#document_Document-toObject). To apply the options to every document of your schema by default, set your [schemas](#schema_Schema) `toJSON` option to the same argument.\n *\n *     schema.set('toJSON', { virtuals: true })\n *\n * See [schema options](/docs/guide.html#toJSON) for details.\n *\n * @param {Object} options\n * @return {Object}\n * @see Document#toObject #document_Document-toObject\n * @api public\n */\n\nDocument.prototype.toJSON = function (options) {\n  return this.$toObject(options, true);\n};\n\n/**\n * Helper for console.log\n *\n * @api public\n */\n\nDocument.prototype.inspect = function (options) {\n  var opts = options && 'Object' == utils.getFunctionName(options.constructor) ? options : {};\n  opts.minimize = false;\n  return inspect(this.toObject(opts));\n};\n\n/**\n * Helper for console.log\n *\n * @api public\n * @method toString\n */\n\nDocument.prototype.toString = Document.prototype.inspect;\n\n/**\n * Returns true if the Document stores the same data as doc.\n *\n * Documents are considered equal when they have matching `_id`s, unless neither\n * document has an `_id`, in which case this function falls back to using\n * `deepEqual()`.\n *\n * @param {Document} doc a document to compare\n * @return {Boolean}\n * @api public\n */\n\nDocument.prototype.equals = function (doc) {\n  var tid = this.get('_id');\n  var docid = doc.get('_id');\n  if (!tid && !docid) {\n    return deepEqual(this, doc);\n  }\n  return tid && tid.equals\n    ? tid.equals(docid)\n    : tid === docid;\n};\n\n/**\n * Populates document references, executing the `callback` when complete.\n *\n * ####Example:\n *\n *     doc\n *     .populate('company')\n *     .populate({\n *       path: 'notes',\n *       match: /airline/,\n *       select: 'text',\n *       model: 'modelName'\n *       options: opts\n *     }, function (err, user) {\n *       assert(doc._id == user._id) // the document itself is passed\n *     })\n *\n *     // summary\n *     doc.populate(path)               // not executed\n *     doc.populate(options);           // not executed\n *     doc.populate(path, callback)     // executed\n *     doc.populate(options, callback); // executed\n *     doc.populate(callback);          // executed\n *\n *\n * ####NOTE:\n *\n * Population does not occur unless a `callback` is passed *or* you explicitly\n * call `execPopulate()`.\n * Passing the same path a second time will overwrite the previous path options.\n * See [Model.populate()](#model_Model.populate) for explaination of options.\n *\n * @see Model.populate #model_Model.populate\n * @param {String|Object} [path] The path to populate or an options object\n * @param {Function} [callback] When passed, population is invoked\n * @api public\n * @return {Document} this\n */\n\nDocument.prototype.populate = function populate () {\n  if (0 === arguments.length) return this;\n\n  var pop = this.$__.populate || (this.$__.populate = {});\n  var args = utils.args(arguments);\n  var fn;\n\n  if ('function' == typeof args[args.length-1]) {\n    fn = args.pop();\n  }\n\n  // allow `doc.populate(callback)`\n  if (args.length) {\n    // use hash to remove duplicate paths\n    var res = utils.populate.apply(null, args);\n    for (var i = 0; i < res.length; ++i) {\n      pop[res[i].path] = res[i];\n    }\n  }\n\n  if (fn) {\n    var paths = utils.object.vals(pop);\n    this.$__.populate = undefined;\n    this.constructor.populate(this, paths, fn);\n  }\n\n  return this;\n};\n\n/**\n * Explicitly executes population and returns a promise. Useful for ES6\n * integration.\n *\n * ####Example:\n *\n *     var promise = doc.\n *       populate('company').\n *       populate({\n *         path: 'notes',\n *         match: /airline/,\n *         select: 'text',\n *         model: 'modelName'\n *         options: opts\n *       }).\n *       execPopulate();\n *\n *     // summary\n *     doc.execPopulate()\n *\n *\n * ####NOTE:\n *\n * Population does not occur unless a `callback` is passed.\n * Passing the same path a second time will overwrite the previous path options.\n * See [Model.populate()](#model_Model.populate) for explaination of options.\n *\n * @see Document.populate #Document_model.populate\n * @api public\n * @return {Promise} promise that resolves to the document when population is done\n */\n\nDocument.prototype.execPopulate = function() {\n  var promise = new Promise;\n  var _this = this;\n\n  this.populate(function(error) {\n    if (error) {\n      return promise.reject(error);\n    }\n    promise.fulfill(_this);\n  });\n  return promise;\n};\n\n/**\n * Gets _id(s) used during population of the given `path`.\n *\n * ####Example:\n *\n *     Model.findOne().populate('author').exec(function (err, doc) {\n *       console.log(doc.author.name)         // Dr.Seuss\n *       console.log(doc.populated('author')) // '5144cf8050f071d979c118a7'\n *     })\n *\n * If the path was not populated, undefined is returned.\n *\n * @param {String} path\n * @return {Array|ObjectId|Number|Buffer|String|undefined}\n * @api public\n */\n\nDocument.prototype.populated = function (path, val, options) {\n  // val and options are internal\n\n  if (val == null) {\n    if (!this.$__.populated) return undefined;\n    var v = this.$__.populated[path];\n    if (v) return v.value;\n    return undefined;\n  }\n\n  // internal\n\n  if (true === val) {\n    if (!this.$__.populated) return undefined;\n    return this.$__.populated[path];\n  }\n\n  this.$__.populated || (this.$__.populated = {});\n  this.$__.populated[path] = { value: val, options: options };\n  return val;\n}\n\n/**\n * Returns the full path to this document.\n *\n * @param {String} [path]\n * @return {String}\n * @api private\n * @method $__fullPath\n * @memberOf Document\n */\n\nDocument.prototype.$__fullPath = function (path) {\n  // overridden in SubDocuments\n  return path || '';\n}\n\n/*!\n * Module exports.\n */\n\nDocument.ValidationError = ValidationError;\nmodule.exports = exports = Document;\n"]}