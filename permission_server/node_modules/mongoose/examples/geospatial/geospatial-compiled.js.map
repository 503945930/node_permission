{"version":3,"sources":["geospatial.js"],"names":[],"mappings":"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","file":"geospatial-compiled.js","sourcesContent":["\n// import async to make control flow simplier\nvar async = require('async');\n\n// import the rest of the normal stuff\nvar mongoose = require('../../lib');\n\nrequire('./person.js')();\n\nvar Person = mongoose.model('Person');\n\n// define some dummy data\nvar data = [\n  { name : 'bill', age : 25, birthday : new Date().setFullYear((new\n    Date().getFullYear() - 25)), gender : \"Male\",\n    likes : ['movies', 'games', 'dogs'], loc : [0, 0]},\n  { name : 'mary', age : 30, birthday : new Date().setFullYear((new\n    Date().getFullYear() - 30)), gender : \"Female\",\n    likes : ['movies', 'birds', 'cats'], loc : [1, 1]},\n  { name : 'bob', age : 21, birthday : new Date().setFullYear((new\n    Date().getFullYear() - 21)), gender : \"Male\",\n    likes : ['tv', 'games', 'rabbits'], loc : [3, 3]},\n  { name : 'lilly', age : 26, birthday : new Date().setFullYear((new\n    Date().getFullYear() - 26)), gender : \"Female\",\n    likes : ['books', 'cats', 'dogs'], loc : [6, 6]},\n  { name : 'alucard', age : 1000, birthday : new Date().setFullYear((new\n    Date().getFullYear() - 1000)), gender : \"Male\",\n    likes : ['glasses', 'wine', 'the night'], loc : [10, 10]},\n];\n\n\nmongoose.connect('mongodb://localhost/persons', function (err) {\n  if (err) throw err;\n\n  // create all of the dummy people\n  async.each(data, function (item, cb) {\n    Person.create(item, cb);\n  }, function (err) {\n    \n    // let's find the closest person to bob\n    Person.find({ name : 'bob' }, function (err, res) {\n      if (err) throw err;\n\n      res[0].findClosest(function (err, closest) {\n        if (err) throw err;\n\n        console.log(\"%s is closest to %s\", res[0].name, closest);\n        \n\n        // we can also just query straight off of the model. For more\n        // information about geospatial queries and indexes, see\n        // http://docs.mongodb.org/manual/applications/geospatial-indexes/\n        var coords = [7,7];\n        Person.find({ loc : { $nearSphere : coords }}).limit(1).exec(function(err, res) {\n          console.log(\"Closest to %s is %s\", coords, res);\n          cleanup();\n        });\n      });\n    });\n  });\n});\n\nfunction cleanup() {\n  Person.remove(function() {\n    mongoose.disconnect();\n  });\n}\n"]}