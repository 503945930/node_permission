{"version":3,"sources":["test.js"],"names":[],"mappings":"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","file":"test-compiled.js","sourcesContent":["var hooks = require('./hooks')\n  , should = require('should')\n  , assert = require('assert')\n  , _ = require('underscore');\n\n// TODO Add in test for making sure all pres get called if pre is defined directly on an instance.\n// TODO Test for calling `done` twice or `next` twice in the same function counts only once\nmodule.exports = {\n  'should be able to assign multiple hooks at once': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook({\n      hook1: function (a) {},\n      hook2: function (b) {}\n    });\n    var a = new A();\n    assert.equal(typeof a.hook1, 'function');\n    assert.equal(typeof a.hook2, 'function');\n  },\n  'should run without pres and posts when not present': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('save', function () {\n      this.value = 1;\n    });\n    var a = new A();\n    a.save();\n    a.value.should.equal(1);\n  },\n  'should run with pres when present': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('save', function () {\n      this.value = 1;\n    });\n    A.pre('save', function (next) {\n      this.preValue = 2;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.value.should.equal(1);\n    a.preValue.should.equal(2);\n  },\n  'should run with posts when present': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('save', function () {\n      this.value = 1;\n    });\n    A.post('save', function (next) {\n      this.value = 2;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.value.should.equal(2);\n  },\n  'should run pres and posts when present': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('save', function () {\n      this.value = 1;\n    });\n    A.pre('save', function (next) {\n      this.preValue = 2;\n      next();\n    });\n    A.post('save', function (next) {\n      this.value = 3;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.value.should.equal(3);\n    a.preValue.should.equal(2);\n  },\n  'should run posts after pres': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('save', function () {\n      this.value = 1;\n    });\n    A.pre('save', function (next) {\n      this.override = 100;\n      next();\n    });\n    A.post('save', function (next) {\n      this.override = 200;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.value.should.equal(1);\n    a.override.should.equal(200);\n  },\n  'should not run a hook if a pre fails': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    var counter = 0;\n    A.hook('save', function () {\n      this.value = 1;\n    }, function (err) {\n      counter++;\n    });\n    A.pre('save', true, function (next, done) {\n      next(new Error());\n    });\n    var a = new A();\n    a.save();\n    counter.should.equal(1);\n    assert.equal(typeof a.value, 'undefined');\n  },\n  'should be able to run multiple pres': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('save', function () {\n      this.value = 1;\n    });\n    A.pre('save', function (next) {\n      this.v1 = 1;\n      next();\n    }).pre('save', function (next) {\n      this.v2 = 2;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.v1.should.equal(1);\n    a.v2.should.equal(2);\n  },\n  'should run multiple pres until a pre fails and not call the hook': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('save', function () {\n      this.value = 1;\n    }, function (err) {});\n    A.pre('save', function (next) {\n      this.v1 = 1;\n      next();\n    }).pre('save', function (next) {\n      next(new Error());\n    }).pre('save', function (next) {\n      this.v3 = 3;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.v1.should.equal(1);\n    assert.equal(typeof a.v3, 'undefined');\n    assert.equal(typeof a.value, 'undefined');\n  },\n  'should be able to run multiple posts': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('save', function () {\n      this.value = 1;\n    });\n    A.post('save', function (next) {\n      this.value = 2;\n      next();\n    }).post('save', function (next) {\n      this.value = 3.14;\n      next();\n    }).post('save', function (next) {\n      this.v3 = 3;\n      next();\n    });\n    var a = new A();\n    a.save();\n    assert.equal(a.value, 3.14);\n    assert.equal(a.v3, 3);\n  },\n  'should run only posts up until an error': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('save', function () {\n      this.value = 1;\n    }, function (err) {});\n    A.post('save', function (next) {\n      this.value = 2;\n      next();\n    }).post('save', function (next) {\n      this.value = 3;\n      next(new Error());\n    }).post('save', function (next) {\n      this.value = 4;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.value.should.equal(3);\n  },\n  \"should fall back first to the hook method's last argument as the error handler if it is a function of arity 1 or 2\": function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    var counter = 0;\n    A.hook('save', function (callback) {\n      this.value = 1;\n    });\n    A.pre('save', true, function (next, done) {\n      next(new Error());\n    });\n    var a = new A();\n    a.save( function (err) {\n      if (err instanceof Error) counter++;\n    });\n    counter.should.equal(1);\n    should.deepEqual(undefined, a.value);\n  },\n  'should fall back second to the default error handler if specified': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    var counter = 0;\n    A.hook('save', function (callback) {\n      this.value = 1;\n    }, function (err) {\n      if (err instanceof Error) counter++;\n    });\n    A.pre('save', true, function (next, done) {\n      next(new Error());\n    });\n    var a = new A();\n    a.save();\n    counter.should.equal(1);\n    should.deepEqual(undefined, a.value);\n  },\n  'fallback default error handler should scope to the object': function () {\n    var A = function () {\n      this.counter = 0;\n    };\n    _.extend(A, hooks);\n    var counter = 0;\n    A.hook('save', function (callback) {\n      this.value = 1;\n    }, function (err) {\n      if (err instanceof Error) this.counter++;\n    });\n    A.pre('save', true, function (next, done) {\n      next(new Error());\n    });\n    var a = new A();\n    a.save();\n    a.counter.should.equal(1);\n    should.deepEqual(undefined, a.value);\n  },\n  'should fall back last to throwing the error': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    var counter = 0;\n    A.hook('save', function (err) {\n      if (err instanceof Error) return counter++;\n      this.value = 1;\n    });\n    A.pre('save', true, function (next, done) {\n      next(new Error());\n    });\n    var a = new A();\n    var didCatch = false;\n    try {\n      a.save();\n    } catch (e) {\n      didCatch = true;\n      e.should.be.an.instanceof(Error);\n      counter.should.equal(0);\n      assert.equal(typeof a.value, 'undefined');\n    }\n    didCatch.should.be.true;\n  },\n  \"should proceed without mutating arguments if `next(null|undefined)` is called in a serial pre, and the last argument of the target method is a callback with node-like signature function (err, obj) {...} or function (err) {...}\": function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    var counter = 0;\n    A.prototype.save = function (callback) {\n      this.value = 1;\n      callback();\n    };\n    A.pre('save', function (next) {\n      next(null);\n    });\n    A.pre('save', function (next) {\n      next(undefined);\n    });\n    var a = new A();\n    a.save( function (err) {\n      if (err instanceof Error) counter++;\n      else counter--;\n    });\n    counter.should.equal(-1);\n    a.value.should.eql(1);\n  },\n  \"should proceed with mutating arguments if `next(null|undefined)` is callback in a serial pre, and the last argument of the target method is not a function\": function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.prototype.set = function (v) {\n      this.value = v;\n    };\n    A.pre('set', function (next) {\n      next(undefined);\n    });\n    A.pre('set', function (next) {\n      next(null);\n    });\n    var a = new A();\n    a.set(1);\n    should.strictEqual(null, a.value);\n  },\n  'should not run any posts if a pre fails': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('save', function () {\n      this.value = 2;\n    }, function (err) {});\n    A.pre('save', function (next) {\n      this.value = 1;\n      next(new Error());\n    }).post('save', function (next) {\n      this.value = 3;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.value.should.equal(1);\n  },\n\n  \"can pass the hook's arguments verbatim to pres\": function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('set', function (path, val) {\n      this[path] = val;\n    });\n    A.pre('set', function (next, path, val) {\n      path.should.equal('hello');\n      val.should.equal('world');\n      next();\n    });\n    var a = new A();\n    a.set('hello', 'world');\n    a.hello.should.equal('world');\n  },\n//  \"can pass the hook's arguments as an array to pres\": function () {\n//    // Great for dynamic arity - e.g., slice(...)\n//    var A = function () {};\n//    _.extend(A, hooks);\n//    A.hook('set', function (path, val) {\n//      this[path] = val;\n//    });\n//    A.pre('set', function (next, hello, world) {\n//      hello.should.equal('hello');\n//      world.should.equal('world');\n//      next();\n//    });\n//    var a = new A();\n//    a.set('hello', 'world');\n//    assert.equal(a.hello, 'world');\n//  },\n  \"can pass the hook's arguments verbatim to posts\": function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('set', function (path, val) {\n      this[path] = val;\n    });\n    A.post('set', function (next, path, val) {\n      path.should.equal('hello');\n      val.should.equal('world');\n      next();\n    });\n    var a = new A();\n    a.set('hello', 'world');\n    assert.equal(a.hello, 'world');\n  },\n//  \"can pass the hook's arguments as an array to posts\": function () {\n//    var A = function () {};\n//    _.extend(A, hooks);\n//    A.hook('set', function (path, val) {\n//      this[path] = val;\n//    });\n//    A.post('set', function (next, halt, args) {\n//      assert.equal(args[0], 'hello');\n//      assert.equal(args[1], 'world');\n//      next();\n//    });\n//    var a = new A();\n//    a.set('hello', 'world');\n//    assert.equal(a.hello, 'world');\n//  },\n  \"pres should be able to modify and pass on a modified version of the hook's arguments\": function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('set', function (path, val) {\n      this[path] = val;\n      assert.equal(arguments[2], 'optional');\n    });\n    A.pre('set', function (next, path, val) {\n      next('foo', 'bar');\n    });\n    A.pre('set', function (next, path, val) {\n      assert.equal(path, 'foo');\n      assert.equal(val, 'bar');\n      next('rock', 'says', 'optional');\n    });\n    A.pre('set', function (next, path, val, opt) {\n      assert.equal(path, 'rock');\n      assert.equal(val, 'says');\n      assert.equal(opt, 'optional');\n      next();\n    });\n    var a = new A();\n    a.set('hello', 'world');\n    assert.equal(typeof a.hello, 'undefined');\n    a.rock.should.equal('says');\n  },\n  'posts should see the modified version of arguments if the pres modified them': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('set', function (path, val) {\n      this[path] = val;\n    });\n    A.pre('set', function (next, path, val) {\n      next('foo', 'bar');\n    });\n    A.post('set', function (next, path, val) {\n      path.should.equal('foo');\n      val.should.equal('bar');\n    });\n    var a = new A();\n    a.set('hello', 'world');\n    assert.equal(typeof a.hello, 'undefined');\n    a.foo.should.equal('bar');\n  },\n  'should pad missing arguments (relative to expected arguments of the hook) with null': function () {\n    // Otherwise, with hookFn = function (a, b, next, ),\n    // if we use hookFn(a), then because the pre functions are of the form\n    // preFn = function (a, b, next, ), then it actually gets executed with\n    // preFn(a, next, ), so when we call next() from within preFn, we are actually\n    // calling ()\n\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('set', function (path, val, opts) {\n      this[path] = val;\n    });\n    A.pre('set', function (next, path, val, opts) {\n      next('foo', 'bar');\n      assert.equal(typeof opts, 'undefined');\n    });\n    var a = new A();\n    a.set('hello', 'world');\n  },\n\n  'should not invoke the target method until all asynchronous middleware have invoked dones': function () {\n    var counter = 0;\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('set', function (path, val) {\n      counter++;\n      this[path] = val;\n      counter.should.equal(7);\n    });\n    A.pre('set', function (next, path, val) {\n      counter++;\n      next();\n    });\n    A.pre('set', true, function (next, done, path, val) {\n      counter++;\n      setTimeout(function () {\n        counter++;\n        done();\n      }, 1000);\n      next();\n    });\n    A.pre('set', function (next, path, val) {\n      counter++;\n      next();\n    });\n    A.pre('set', true, function (next, done, path, val) {\n      counter++;\n      setTimeout(function () {\n        counter++;\n        done();\n      }, 500);\n      next();\n    });\n    var a = new A();\n    a.set('hello', 'world');\n  },\n\n  'invoking a method twice should run its async middleware twice': function () {\n    var counter = 0;\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('set', function (path, val) {\n      this[path] = val;\n      if (path === 'hello') counter.should.equal(1);\n      if (path === 'foo') counter.should.equal(2);\n    });\n    A.pre('set', true, function (next, done, path, val) {\n      setTimeout(function () {\n        counter++;\n        done();\n      }, 1000);\n      next();\n    });\n    var a = new A();\n    a.set('hello', 'world');\n    a.set('foo', 'bar');\n  },\n\n  'calling the same done multiple times should have the effect of only calling it once': function () {\n    var A = function () {\n      this.acked = false;\n    };\n    _.extend(A, hooks);\n    A.hook('ack', function () {\n      console.log(\"UH OH, YOU SHOULD NOT BE SEEING THIS\");\n      this.acked = true;\n    });\n    A.pre('ack', true, function (next, done) {\n      next();\n      done();\n      done();\n    });\n    A.pre('ack', true, function (next, done) {\n      next();\n      // Notice that done() is not invoked here\n    });\n    var a = new A();\n    a.ack();\n    setTimeout( function () {\n      a.acked.should.be.false;\n    }, 1000);\n  },\n\n  'calling the same next multiple times should have the effect of only calling it once': function (beforeExit) {\n    var A = function () {\n      this.acked = false;\n    };\n    _.extend(A, hooks);\n    A.hook('ack', function () {\n      console.log(\"UH OH, YOU SHOULD NOT BE SEEING THIS\");\n      this.acked = true;\n    });\n    A.pre('ack', function (next) {\n      // force a throw to re-exec next()\n      try {\n        next(new Error('bam'));\n      } catch (err) {\n        next();\n      }\n    });\n    A.pre('ack', function (next) {\n      next();\n    });\n    var a = new A();\n    a.ack();\n    beforeExit( function () {\n      a.acked.should.be.false;\n    });\n  },\n\n  'asynchronous middleware should be able to pass an error via `done`, stopping the middleware chain': function () {\n    var counter = 0;\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('set', function (path, val, fn) {\n      counter++;\n      this[path] = val;\n      fn(null);\n    });\n    A.pre('set', true, function (next, done, path, val, fn) {\n      setTimeout(function () {\n        counter++;\n        done(new Error);\n      }, 1000);\n      next();\n    });\n    var a = new A();\n    a.set('hello', 'world', function (err) {\n      err.should.be.an.instanceof(Error);\n      should.strictEqual(undefined, a['hello']);\n      counter.should.eql(1);\n    });\n  },\n\n  'should be able to remove a particular pre': function () {\n    var A = function () {}\n      , preTwo;\n    _.extend(A, hooks);\n    A.hook('save', function () {\n      this.value = 1;\n    });\n    A.pre('save', function (next) {\n      this.preValueOne = 2;\n      next();\n    });\n    A.pre('save', preTwo = function (next) {\n      this.preValueTwo = 4;\n      next();\n    });\n    A.removePre('save', preTwo);\n    var a = new A();\n    a.save();\n    a.value.should.equal(1);\n    a.preValueOne.should.equal(2);\n    should.strictEqual(undefined, a.preValueTwo);\n  },\n\n  'should be able to remove all pres associated with a hook': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('save', function () {\n      this.value = 1;\n    });\n    A.pre('save', function (next) {\n      this.preValueOne = 2;\n      next();\n    });\n    A.pre('save', function (next) {\n      this.preValueTwo = 4;\n      next();\n    });\n    A.removePre('save');\n    var a = new A();\n    a.save();\n    a.value.should.equal(1);\n    should.strictEqual(undefined, a.preValueOne);\n    should.strictEqual(undefined, a.preValueTwo);\n  },\n\n  '#pre should lazily make a method hookable': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.prototype.save = function () {\n      this.value = 1;\n    };\n    A.pre('save', function (next) {\n      this.preValue = 2;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.value.should.equal(1);\n    a.preValue.should.equal(2);\n  },\n\n  '#pre lazily making a method hookable should be able to provide a default errorHandler as the last argument': function () {\n    var A = function () {};\n    var preValue = \"\";\n    _.extend(A, hooks);\n    A.prototype.save = function () {\n      this.value = 1;\n    };\n    A.pre('save', function (next) {\n      next(new Error);\n    }, function (err) {\n      preValue = 'ERROR';\n    });\n    var a = new A();\n    a.save();\n    should.strictEqual(undefined, a.value);\n    preValue.should.equal('ERROR');\n  },\n\n  '#post should lazily make a method hookable': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.prototype.save = function () {\n      this.value = 1;\n    };\n    A.post('save', function (next) {\n      this.value = 2;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.value.should.equal(2);\n  },\n\n  \"a lazy hooks setup should handle errors via a method's last argument, if it's a callback\": function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.prototype.save = function (fn) {};\n    A.pre('save', function (next) {\n      next(new Error(\"hi there\"));\n    });\n    var a = new A();\n    a.save( function (err) {\n      err.should.be.an.instanceof(Error);\n    });\n  },\n\n  'should intercept method callbacks for post handlers': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('save', function (val, callback) {\n      this.value = val;\n      callback();\n    });\n    A.post('save', function (next) {\n      assert.equal(a.value, 2);\n      this.value += 2;\n      setTimeout(next, 10);\n    }).post('save', function (next) {\n      assert.equal(a.value, 4);\n      this.value += 3;\n      setTimeout(next, 10);\n    }).post('save', function (next) {\n      assert.equal(a.value, 7);\n      this.value2 = 3;\n      setTimeout(next, 10);\n    });\n    var a = new A();\n    a.save(2, function(){\n      assert.equal(a.value, 7);\n      assert.equal(a.value2, 3);\n    });\n  },\n\n  'should handle parallel followed by serial': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.hook('save', function (val, callback) {\n      this.value = val;\n      callback();\n    });\n    A.pre('save', true, function(next, done) {\n      process.nextTick(function() {\n        done();\n      });\n      next();\n    }).pre('save', function(done) {\n      process.nextTick(function() {\n        done();\n      });\n    });\n    var a = new A();\n    a.save(2, function(){\n      assert.ok(true);\n    });\n  }\n};\n"]}